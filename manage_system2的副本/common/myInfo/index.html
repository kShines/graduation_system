<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>个人信息</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="/ok-admin/css/oksub.css" media="all" />
    <script src="/ok-admin/lib/layui/layui.js"></script>
    <link rel="stylesheet" href="/common/myWork/index.css" media="all" />
    <style>
        .layui-form-pane .layui-form-label {

            height: 35px;
            line-height: 20px;
            border-width: 0px;
            border-style: solid;
            /* border-radius: 2px 0 0 2px; */
            text-align: center;
            background-color: #fbfbfb00;
            overflow: hidden;
            box-sizing: border-box;
            font-size: 18px;
        }

        .layui-form-pane .layui-form-text .layui-textarea {
            min-height: 350px;
            border-radius: 0 0 2px 2px;
            font-size: 16px;
        }

        .layui-form-radio>i:hover,
        .layui-form-radioed>i {
            color: #57b1ff;
        }

        .layui-input {
            height: 38px;
            line-height: 1.3;
            line-height: 38px\9;
            border-width: 0px;
            border-style: solid;
            background-color: rgb(0 0 0 / 0%);
            border-radius: 2px;
            font-size: 18px;
            color: black;
        }
    </style>
</head>

<body>
    <div class="layui-header">
        <div class="toolbar">
            <div class="nva_title">
                <span>个人信息</span>
            </div>
        </div>
        <ul class="layui-fixbar">
            
            <a href="/common/index.html">
                <li class="layui-icon layui-icon-home" lay-type="bar1" style="display: list-item;"></li>
            </a>
            <a href="/common/index.html">
                <li class="layui-icon layui-icon-return" lay-type="bar2" style="display: list-item;"></li>
            </a>
        </ul>
    </div>

    <div class="content">
        <div class="layui-container">
            <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
                <legend>个人信息</legend>
              </fieldset>
            <form class="layui-form layui-form-pane" action="" lay-filter="example" style="text-align: center;">
                <div class="layui-form-item">
                    <label class="layui-form-label">姓 名</label>
                    <div class="layui-input-block">
                        <input id="name" type="text" name="username" lay-verify="title" autocomplete="off" value="薛宝钗"
                            class="layui-input" disabled="disabled">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">手机号码</label>
                    <div class="layui-input-block">
                        <input id="username" type="text" name="" lay-verify="title" autocomplete="off"
                        value="1515881515" class="layui-input" disabled="disabled">
                    </div>
                </div>
                <hr>
                <div class="layui-form-item">
                    <label class="layui-form-label">所属单位</label>
                    <div class="layui-input-block">
                        <input id="organization" type="text" name="" lay-verify="title" autocomplete="off" value="中共萧山区组织部"
                            class="layui-input" disabled="disabled">
                    </div>
                </div>
                
                <div class="layui-form-item">
                    <label class="layui-form-label">所任职务</label>
                    <div class="layui-input-block">
                        <input id="organization_position" type="text" name="" lay-verify="title" autocomplete="off" value="所任职务"
                            class="layui-input" disabled="disabled">
                    </div>
                </div>
                <hr>
                <div class="layui-form-item">
                    <label class="layui-form-label">考核单位</label>
                    <div class="layui-input-block">
                        <input id="assess_organization" type="text" name="" lay-verify="title" autocomplete="off" value="中共萧山区组织部"
                            class="layui-input" disabled="disabled">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">考核职务</label>
                    <div class="layui-input-block">
                        <input id="assess_organization_position" type="text" name="" lay-verify="title" autocomplete="off" value="所任职务"
                            class="layui-input" disabled="disabled">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">考核组</label>
                    <div class="layui-input-block">
                        <input id="assess_group" type="text" name="" lay-verify="title" autocomplete="off" value="所任职务"
                            class="layui-input" disabled="disabled">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">开始时间</label>
                    <div class="layui-input-block">
                        <input id="group_start_time" type="text" name="" lay-verify="title" autocomplete="off" value="所任职务"
                            class="layui-input" disabled="disabled">
                    </div>
                </div>
                <!-- <div class="layui-form-item">
                    <label class="layui-form-label">参与考核</label>
                    <div class="layui-input-block">
                        <input id="is_assess" type="text" name="" lay-verify="title" autocomplete="off" value="是"
                            class="layui-input" disabled="disabled">
                    </div>
                </div> -->
                <hr>
            </form>

            <fieldset class="layui-elem-field layui-field-title" style="margin-top: 50px;">
                <legend>修改密码</legend>
              </fieldset>
              <form class="layui-form layui-form-pane" action="" lay-filter="example" style="text-align: center;">
                <div class="layui-form-item">
                    <label class="layui-form-label">原密码</label>
                    <div class="layui-input-block">
                        <input type="password" id="old_password" type="text" name="old_password" lay-verify="title" autocomplete="off" placeholder="初始密码"
                            class="layui-input" >
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">新密码</label>
                    <div class="layui-input-block">
                        <input type="password" id="new_password" type="text" name="new_password" lay-verify="title" autocomplete="off"
                            placeholder="新密码" class="layui-input" disable>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">再输一遍</label>
                    <div class="layui-input-block">
                        <input type="password" id="new_password_2" type="text" name="new_password_2" lay-verify="title" autocomplete="off" placeholder="新密码"
                            class="layui-input" disable>
                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-input-block">
                        <button type="submit" class="layui-btn login_btn layui-btn-normal" lay-submit lay-filter="modify_password"
                            style="width:60%">修改密码</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

</body>


<script>
    layui.use(["table", "element", "form", "laydate", "upload", "util"], function () {
        var form = layui.form
            , table = layui.table
            , element = layui.element
            , laydate = layui.laydate
            , util = layui.util
            , $ = layui.jquery
            , classId = 1;

        var storage = window.localStorage;

        $.ajax({
            url: 'http://localhost:8090/api/getUserInfoById',
            method: 'POST',
            crossDomain: true,
            xhrFields: {
                withCredentials: true
            },
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            data: JSON.stringify({
                'user_id': parseInt(storage.getItem("user_id"))
            }),
            success: function (data) {
                // console.log(data);
                $("#name").val(data.body.name);
                $("#username").val(data.body.phoneNumber);
                $("#organization").val(data.body.organization);
                $("#organization_position").val(data.body.position);
                $("#assess_organization").val(data.body.assess_organization);
                $("#assess_organization_position").val(data.body.assess_position);
                $("#assess_group").val(data.body.assess_group);
                $("#group_start_time").val(data.body.group_start_time);
                $("#is_assess").val(data.body.is_assess);
            }
        });
        
        form.on('submit(modify_password)', function(data){
            console.log(data);
            if(data.field.new_password != data.field.new_password_2){
                alert("输入密码不一致");
            } else {
                $.ajax({
                    url: 'http://localhost:8090/api/modifyUserInfo',
                    method: 'POST',
                    crossDomain: true,
                    xhrFields: {
                        withCredentials: true
                    },
                    contentType: "application/json;charset=utf-8",
                    dataType: "json",
                    data: JSON.stringify({
                        'user_id': parseInt(storage.getItem("user_id")),
                        'old_password': data.field.old_password,
                        'new_password': data.field.new_password
                    }),
                    success: function(data){
                        alert(data.header.message);
                        
                    }
                });
            }
            return false;
        });
        
    });
</script>